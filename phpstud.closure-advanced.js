(function(){function m(){e.clearRect(0,0,b.width,b.height);var a=e.createLinearGradient(0,0,0,b.height);a.addColorStop(0,"rgba(0, 150, 255, 0.3)");a.addColorStop(1,"rgba(0, 150, 255, 0.7)");e.fillStyle=a;e.fillRect(0,0,b.width,b.height);a=i.text+": "+j;e.fillStyle=i.d;e.fillRect(0,b.height-c.height,b.width,c.height);e.font="bold "+c.height/2+"px sans-serif";e.fillStyle="rgba(255, 255, 255, 1)";e.textBaseline="top";e.fillText(a,c.width/4,b.height-c.height/1.2);d.b-=1;if(d.a===g.a)d.a=h();d.b===g.b&&
d.a===g.a&&(d.b-=1);if(d.b<0)d.b=Math.floor(b.width/c.width),d.a=h();e.drawImage(d.c,d.b*c.width+1,d.a*c.height+1);e.drawImage(g.c,g.b*c.width+1,g.a*c.height+1)}function h(){var a=Math.floor(Math.random()*(b.height/c.height-2));a<0&&(a=0);a>b.height/c.height-2&&(a=b.height/c.height-2);return a}function n(a){var f;a.pageX!==void 0&&a.pageY!==void 0?(f=a.pageX,a=a.pageY):(f=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a=a.clientY+document.body.scrollTop+document.documentElement.scrollTop);
f-=b.offsetLeft;a-=b.offsetTop;f=Math.min(f,b.width);a=Math.min(a,b.height);f=new Cell(Math.floor(f/c.width),Math.floor(a/c.height));if(f.a!==Math.floor(b.height/c.height-1))g.b=f.b,g.a=f.a,d.b===g.b&&d.a===g.a&&(j+=1)}var b,e,c,g,d,i,j;Tile=function(a,b){this.width=a;this.height=b};Cell=function(a,b){this.b=a;this.a=b};Sprite=function(a,b,c){this.c=new Image;this.c.src=a;this.b=b;this.a=c};ScoreMessage=function(a,b){this.text=a;this.d=b};return{e:function(a,f,h,l,k,o,p,q,r,s){b=document.getElementById(a);
e=b.getContext("2d");b.setAttribute("width",f*l);b.setAttribute("height",h*k+k);c=new Tile(l,k);g=new Sprite(o,1,1);d=new Sprite(p,Math.floor(b.width/c.width),Math.floor(b.height/c.height)-3);j=0;i=new ScoreMessage(r,s);b.addEventListener("click",n,!1);setInterval(m,1E3/q)}}})();